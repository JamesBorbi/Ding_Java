package cn.jpush.alertme.factory.plugins.pm25;import cn.jpush.alertme.factory.common.http.HttpRequestException;import cn.jpush.alertme.factory.common.http.NativeHttpClient;import cn.jpush.alertme.factory.util.JsonUtil;import com.google.gson.reflect.TypeToken;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import java.io.IOException;import java.io.InputStream;import java.net.URLEncoder;import java.util.List;/** * Created by chenyueling on 2014/8/13. */public class Pm25Util {    private static final Logger LOG = LoggerFactory.getLogger(Pm25Util.class);    private Pm25Util() {    }    ;    //PM查询接口    //http://www.pm25.in/ 提供的AppScret 测试keys    //private static String token = "5j1znBVAsnSf5xQyNQyq";    //申请keys    private static String token = "GDRTVxGEmmXEDmoGeEqk";    private static String api = "http://www.pm25.in/api/querys/pm2_5.json?&token=" + token + "&city=";    /**     * 通过城市名获取该城市平均PM对象     *     * @return     */    public static PM25 getPmAvgByCityName(String cityName) throws IOException, HttpRequestException {        PM25 particulateMatter = null;        InputStream inputStream = null;        try {            cityName = URLEncoder.encode(cityName, "UTF-8");            String uri = api + cityName;            ///InputStream inputStream = new FileInputStream("PM.json");            LOG.info("[PM25] api:" + uri);            String json = NativeHttpClient.get(uri);            System.out.println(json);            LOG.info("[PM25] api response result json" + json);            List<PM25> mitigations = JsonUtil.jsonToList(json, new TypeToken<List<PM25>>() {            }.getType());            int size = mitigations.size();            if (mitigations != null && size > 0) {                particulateMatter = mitigations.get(size - 1);            }        } catch (Exception e) {            throw e;        } finally {            if (inputStream != null) {                inputStream.close();                inputStream = null;            }        }        return particulateMatter;    }    public static void main(String[] args) throws IOException {        try {            System.out.println(getPmAvgByCityName("珠海"));        } catch (HttpRequestException e) {            e.printStackTrace();        }    }    public class PM25 {        public int aqi;        public String area;        public int pm2_5;        public String pm2_5_24h;        public String position_name;        public String primary_pollutant;        public String quality;        public String station_code;        public String time_point;    }}